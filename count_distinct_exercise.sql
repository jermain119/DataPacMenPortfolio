SELECT
  state,  -- Select the state column
  COUNT(DISTINCT order_id) AS num_orders  -- Count the number of distinct orders for each state
FROM
  `companysilo.wharehouse_orders.orders` AS orders  -- Specify the orders table with alias
JOIN
  `companysilo.wharehouse_orders.warehouse` AS warehouse  -- Join with the warehouse table using alias
ON
  orders.warehouse_id = warehouse.warehouse_id  -- Match orders with warehouses by warehouse_id
GROUP BY
 orders.state  -- Group the results by state
